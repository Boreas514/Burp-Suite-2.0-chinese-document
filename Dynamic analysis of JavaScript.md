# JavaScript动态分析

burp旧的扫描器使用静态分析技术，可以发现广泛的基于DOM的漏洞。

静态分析将代码转为一个抽象语法树结构，识别受污染的源和危险的接收器，定位代码中可能的数据流，以识别恶意数据从源传播到接收器的路径。

burp新的扫描器有了一个超级棒的新功能。它可以动态分析JavaScript然后找出DOM的漏洞。

动态和静态分析各有所长：

- 静态分析可以找出动态分析遗漏的漏洞，因为某些代码会在特定的情况下执行，可能动态分析不会执行。然而，静态分析容易出现误报和噪声，因为它认为一些代码路径可能可以执行，但实际上它们是不可执行的，而且它不能理解自定义数据验证逻辑，这意味着从源到汇聚的污染路径实际上是不可利用的。

- 静态分析具有相反的特点。它不太容易出现误报，因为如果它在执行期间实际观察到从源传播到sink的适当数据，那么这就是漏洞的具体证据。但是，在由于应用程序的当前状态或其他数据的值而导致注入的受污染数据无法到达sink的情况下，它可能会遭受错误的否定，攻击者实际上可以控制这两种情况。

Burp对JavaScript的最新动态分析使用了嵌入式的无头部浏览器。它将HTTP响应加载到浏览器中，在攻击者可能控制的位置向DOM注入payloads，并在响应中执行JavaScript。它还通过创建鼠标事件与页面交互，以实现尽可能多的代码覆盖。它可以监视用于执行攻击的危险接收器，以识别任何注入到这些接收器的payloads。

新的JavaScript分析已经开发了好几个月了，在此期间，我们对它进行了针对众多bug bounty站点的测试，发现了大量现有工具无法找到的可利用漏洞。所以我们知道它是如何工作的:
![](https://portswigger.net/cms/images/61/6c/1173cfb96079-article-dynamic_javascript_analysis.png)

但它开始变得更好了。新的扫描仪仍然执行其老式的静态分析，并利用这两种方法的联合优点。它将这两种技术的结果联系起来，并在可用的情况下将两种类型的证据结合在一起。这些问题如果被认为是确凿的就会被报告。在只有静态分析才能发现潜在问题的情况下，Burp会降低报告问题的可信度。这种集成的JavaScript分析方法极大地帮助了正在评审结果的测试人员找到最重要的问题。
